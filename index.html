<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elegant COVID-19 Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #2c3e50;
            --secondary: #34495e;
            --accent: #3498db;
            --confirmed: #e74c3c;
            --active: #f39c12;
            --recovered: #2ecc71;
            --deaths: #7f8c8d;
            --text: #ecf0f1;
            --card-bg: rgba(255, 255, 255, 0.1);
            --hover-bg: rgba(255, 255, 255, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
            background-attachment: fixed;
            color: var(--text);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 10px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        header h1 i {
            color: var(--accent);
            margin-right: 10px;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .dashboard {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .section-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cards-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            background: var(--hover-bg);
        }

        .stat-card h3 {
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .stat-card p {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .delta {
            font-size: 0.9rem;
            padding: 5px 10px;
            border-radius: 20px;
            display: inline-block;
        }

        .confirmed {
            border-top: 4px solid var(--confirmed);
        }

        .confirmed .delta {
            background: rgba(231, 76, 60, 0.2);
            color: #ff9f9f;
        }

        .active {
            border-top: 4px solid var(--active);
        }

        .active .delta {
            background: rgba(243, 156, 18, 0.2);
            color: #ffd699;
        }

        .recovered {
            border-top: 4px solid var(--recovered);
        }

        .recovered .delta {
            background: rgba(46, 204, 113, 0.2);
            color: #90ff90;
        }

        .deaths {
            border-top: 4px solid var(--deaths);
        }

        .deaths .delta {
            background: rgba(127, 140, 141, 0.2);
            color: #d9d9d9;
        }

        .country-data {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .country-selector {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 15px;
        }

        .country-selector label {
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #country-select {
            flex: 1;
            min-width: 200px;
            padding: 12px 15px;
            border: none;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.2);
            color: var(--text);
            font-size: 1rem;
            outline: none;
            cursor: pointer;
        }

        #country-select option {
            background: var(--secondary);
            color: var(--text);
        }

        .charts {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .chart-container {
            position: relative;
            height: 400px;
            margin-top: 20px;
        }

        footer {
            text-align: center;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 10px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        footer a {
            color: var(--accent);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        .loading {
            text-align: center;
            padding: 20px;
            font-size: 1.2rem;
        }

        .loading i {
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        @media (max-width: 768px) {
            .cards-container {
                grid-template-columns: 1fr;
            }

            header h1 {
                font-size: 2rem;
            }

            .stat-card p {
                font-size: 1.5rem;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-virus"></i> COVID-19 Dashboard</h1>
            <p>Track global coronavirus statistics with our elegant and intuitive dashboard</p>
        </header>

        <div class="dashboard">
            <div class="global-stats">
                <h2 class="section-title"><i class="fas fa-globe-americas"></i> Global Statistics</h2>
                <div class="cards-container">
                    <div class="stat-card confirmed">
                        <h3><i class="fas fa-plus-circle"></i> Confirmed</h3>
                        <p id="confirmed-total">Loading...</p>
                        <div class="delta" id="confirmed-delta">+0</div>
                    </div>
                    <div class="stat-card active">
                        <h3><i class="fas fa-procedures"></i> Active</h3>
                        <p id="active-total">Loading...</p>
                        <div class="delta" id="active-delta">+0</div>
                    </div>
                    <div class="stat-card recovered">
                        <h3><i class="fas fa-heart"></i> Recovered</h3>
                        <p id="recovered-total">Loading...</p>
                        <div class="delta" id="recovered-delta">+0</div>
                    </div>
                    <div class="stat-card deaths">
                        <h3><i class="fas fa-cross"></i> Deaths</h3>
                        <p id="deaths-total">Loading...</p>
                        <div class="delta" id="deaths-delta">+0</div>
                    </div>
                </div>
            </div>

            <div class="country-data">
                <div class="country-selector">
                    <label for="country-select"><i class="fas fa-flag"></i> Choose a Country:</label>
                    <select id="country-select">
                        <option value="global">Global</option>
                        <!-- Countries will be populated by JavaScript -->
                    </select>
                </div>
            </div>

            <div class="charts">
                <h2 class="section-title"><i class="fas fa-chart-line"></i> Historical Data (Last 30 Days)</h2>
                <div class="chart-container">
                    <canvas id="covidChart"></canvas>
                </div>
            </div>
        </div>

        <footer>
            <p>Data sourced from <a href="https://disease.sh/" target="_blank">disease.sh</a> | Elegant COVID-19
                Dashboard</p>
        </footer>
    </div>

    <script>
        // Global variables
        let covidChart;
        let countriesData = [];

        // DOM Elements
        const countrySelect = document.getElementById('country-select');
        const confirmedTotal = document.getElementById('confirmed-total');
        const activeTotal = document.getElementById('active-total');
        const recoveredTotal = document.getElementById('recovered-total');
        const deathsTotal = document.getElementById('deaths-total');
        const confirmedDelta = document.getElementById('confirmed-delta');
        const activeDelta = document.getElementById('active-delta');
        const recoveredDelta = document.getElementById('recovered-delta');
        const deathsDelta = document.getElementById('deaths-delta');

        // Initialize the dashboard
        document.addEventListener('DOMContentLoaded', function () {
            fetchGlobalData();
            fetchCountries();
            setupEventListeners();
        });

        // Set up event listeners
        function setupEventListeners() {
            countrySelect.addEventListener('change', function () {
                if (this.value === 'global') {
                    fetchGlobalData();
                } else {
                    fetchCountryData(this.value);
                }
            });
        }

        // Fetch global COVID data
        async function fetchGlobalData() {
            try {
                showLoading();
                const response = await fetch('https://disease.sh/v3/covid-19/all');
                const data = await response.json();

                updateGlobalStats(data);
                fetchHistoricalData('all');
            } catch (error) {
                console.error('Error fetching global data:', error);
                showError();
            }
        }

        // Fetch country list
        async function fetchCountries() {
            try {
                const response = await fetch('https://disease.sh/v3/covid-19/countries');
                const data = await response.json();

                // Sort countries alphabetically
                data.sort((a, b) => a.country.localeCompare(b.country));

                // Add countries to dropdown
                data.forEach(country => {
                    const option = document.createElement('option');
                    option.value = country.countryInfo.iso3 || country.country;
                    option.textContent = country.country;
                    countrySelect.appendChild(option);
                });

                countriesData = data;
            } catch (error) {
                console.error('Error fetching countries:', error);
            }
        }

        // Fetch data for a specific country
        async function fetchCountryData(countryCode) {
            try {
                showLoading();
                const response = await fetch(`https://disease.sh/v3/covid-19/countries/${countryCode}`);
                const data = await response.json();

                updateGlobalStats(data);
                fetchHistoricalData(countryCode);
            } catch (error) {
                console.error('Error fetching country data:', error);
                showError();
            }
        }

        // Fetch historical data for charts
        async function fetchHistoricalData(identifier) {
            try {
                const response = await fetch(`https://disease.sh/v3/covid-19/historical/${identifier}?lastdays=30`);
                const data = await response.json();

                // Handle both global and country data structures
                const timelineData = identifier === 'all' ? data : data.timeline;

                updateChart(timelineData);
            } catch (error) {
                console.error('Error fetching historical data:', error);
            }
        }

        // Update the global/country stats cards
        function updateGlobalStats(data) {
            confirmedTotal.textContent = formatNumber(data.cases);
            activeTotal.textContent = formatNumber(data.active);
            recoveredTotal.textContent = formatNumber(data.recovered);
            deathsTotal.textContent = formatNumber(data.deaths);

            confirmedDelta.textContent = `+${formatNumber(data.todayCases)}`;
            activeDelta.textContent = `${data.todayCases - data.todayDeaths > 0 ? '+' : ''}${formatNumber(data.todayCases - data.todayDeaths)}`;
            recoveredDelta.textContent = `+${formatNumber(data.todayRecovered)}`;
            deathsDelta.textContent = `+${formatNumber(data.todayDeaths)}`;
        }

        // Update the chart with historical data
        function updateChart(data) {
            const ctx = document.getElementById('covidChart').getContext('2d');

            // Destroy previous chart if it exists
            if (covidChart) {
                covidChart.destroy();
            }

            // Prepare data for chart
            const dates = Object.keys(data.cases);
            const cases = Object.values(data.cases);
            const recovered = Object.values(data.recovered);
            const deaths = Object.values(data.deaths);

            // Create new chart
            covidChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [
                        {
                            label: 'Confirmed Cases',
                            data: cases,
                            borderColor: '#e74c3c',
                            backgroundColor: 'rgba(231, 76, 60, 0.1)',
                            borderWidth: 2,
                            tension: 0.2,
                            fill: true
                        },
                        {
                            label: 'Recovered',
                            data: recovered,
                            borderColor: '#2ecc71',
                            backgroundColor: 'rgba(46, 204, 113, 0.1)',
                            borderWidth: 2,
                            tension: 0.2,
                            fill: true
                        },
                        {
                            label: 'Deaths',
                            data: deaths,
                            borderColor: '#7f8c8d',
                            backgroundColor: 'rgba(127, 140, 141, 0.1)',
                            borderWidth: 2,
                            tension: 0.2,
                            fill: true
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: '#ecf0f1'
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                color: '#ecf0f1',
                                maxTicksLimit: 10
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        y: {
                            ticks: {
                                color: '#ecf0f1'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        // Helper function to format large numbers
        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(2) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num;
        }

        // Show loading state
        function showLoading() {
            confirmedTotal.textContent = 'Loading...';
            activeTotal.textContent = 'Loading...';
            recoveredTotal.textContent = 'Loading...';
            deathsTotal.textContent = 'Loading...';

            confirmedDelta.textContent = '+0';
            activeDelta.textContent = '+0';
            recoveredDelta.textContent = '+0';
            deathsDelta.textContent = '+0';
        }

        // Show error state
        function showError() {
            confirmedTotal.textContent = 'Error';
            activeTotal.textContent = 'Error';
            recoveredTotal.textContent = 'Error';
            deathsTotal.textContent = 'Error';

            confirmedDelta.textContent = '+0';
            activeDelta.textContent = '+0';
            recoveredDelta.textContent = '+0';
            deathsDelta.textContent = '+0';
        }
    </script>
</body>

</html>
